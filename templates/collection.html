<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Tag Meta yang Diperlukan -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <meta property="og:title" content="Bucket Tangan Navirins" />
    <meta property="og:description" content="Apakah kamu mencari bucket tangan hias?" />
    <meta property="og:image" content="{{ url_for('static', filename='') }}" />

    <!-- Judul Halaman Web -->
    <title>Navirin's</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../static/img/favicon.ico" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet" />

    <!-- CSS Files -->
    <link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" rel="stylesheet" />
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>

    <!-- Header -->
    <header id="header" class="fixed-top">
        <div class="container d-flex align-items-center justify-content-between">

            <h1 class="logo"><a href="/">Navirin's</a></h1>

            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link scrollto" href="/">Beranda</a></li>
                    <li><a class="nav-link scrollto " href="/koleksi">Koleksi Buket</a></li>
                    <li class="dropdown">
                        <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
                            <img src="{{ url_for('static', filename=user_info.profile_pic_real) }}" alt="Profile" class="rounded-circle profile-pic">
                            <span class="d-none d-md-block dropdown-toggle ps-2">{{ user_info.profile_name }}</span>
                        </a>
                        <ul>
                            <li><a href="/profil/{{ user_info.account_name }}">Profil</a></li>
                            <!-- <li>
                                <a class= "d-flex align-items-center" href="/obrolan/{{ user_info.account_name }}">
                                    <i class="bi bi-chat-left-dots"></i>
                                    <span class="text-start">Obrolan</span>
                                </a>
                            </li> -->
                            <li><a href="/obrolan/{{ user_info.account_name }}">Obrolan</a></li>
                            <li><a href="/histori-pembayaran/{{ user_info.account_name }}">Histori Pembayaran</a></li>
                            <li><a href="/status-pengiriman/{{ user_info.account_name }}">Status Pengiriman</a></li>
                            <li><a href="#" onclick="logout()">Keluar</a></li>
                        </ul>
                    </li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav>

        </div>
    </header>

    <main id="main" class="mt-5">

        <!-- Koleksi Section -->
        <section id="portfolio" class="portfolio">
            <div class="container" data-aos="fade-up">
                <div class="section-title">
                    <h2>Koleksi Bucket</h2>
                    <p>Pilihan Koleksi Bucket</p>
                    <!-- Tambah Bucket Button -->
                    <div class="container my-4 text-center">
                        <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#tambahBucketModal">
                            Tambah Bucket
                        </button>
                    </div>
                </div>

                <div class="row" data-aos="fade-up" data-aos-delay="100">
                    <div class="col-lg-12 d-flex justify-content-center">
                        <ul id="portfolio-flters">
                            <li data-filter="*" class="filter-active">Semua</li>
                            <li data-filter=".filter-atificial">Artificial Full Flower Hand Bouquet</li>
                            <li data-filter=".filter-money">Money Hand Bouquet</li>
                            <li data-filter=".filter-hand">Hand Bouquet Snack</li>
                        </ul>
                    </div>
                </div>

                <!-- Deskripsi Filter -->
                <div class="row" data-aos="fade-up" data-aos-delay="150">
                    <div class="col-md-12 md-5 d-flex justify-content-center">
                        <div id="filter-descriptions">
                            <div class="filter-description" id="filter-atificial-description">
                                <p>
                                    <small> Bunga artificial adalah bunga yang berbahan sintesis atau plastic.
                                    Meskipun tidak hidup, bunga artificial memiliki daya tarik dan kegunaan yang tak kalah indah.Tidak heran kalau bunga artificial ini popular di berbagai macam acara.</small>
                                </p>
                                <hr>
                            </div>
                            <div class="filter-description" id="filter-money-description">
                                <p>
                                    <small>Bunga uang yang terdiri atas artificial flowers dan uang tunai. Merupakan pilihan yang praktis dan tepat untuk diberikan sebagai hadiah atau bentuk penghargaan, sangat cocok di berbagai acara dan kalangan.
                                    Kamu bisa memilih pecahan uang berapa saja untuk ditambahkan di Money Bouquet. Harga untuk produk ini sudah termasuk artificial flowers dan belum termasuk uang tunai yang diinginkan.</small>
                                </p>
                                <hr>
                            </div>
                            <div class="filter-description" id="filter-hand-description">
                                <p>
                                    <small>Bunga snack yang berisi aneka macam snack. Isi snack dari buket ini dapat kamu request sesuai dengan keinginan kamu. 
                                    Harga udah termasuk artificial flowers dan belum termasuk snack dan kartu ucapan.</small>
                                </p>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row portfolio-container mt-3" data-aos="fade-up" data-aos-delay="200">
                    {% for collection in collections %}
                        {% if collection.category == 'filter-artificial' %}
                        <div class="col-lg-4 col-md-6 portfolio-item filter-atificial">
                            <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                            <div class="portfolio-info">
                                <h4>{{ collection.name }}</h4>
                                <p>{{ collection.description }}</p>
                                <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bx-plus"></i></a>
                                <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                <a href="#" class="card-text edit-btn" title="Edit" data-bs-toggle="modal" data-bs-target="#editBucketModal{{ collection._id }}"><i class="bx bx-edit" style="margin-left: 10px; font-size: 20px;"></i></a>
                                <a href="#" class="card-text delete-btn" title="Delete" data-bs-toggle="modal" data-bs-target="#deleteBucketModal{{ collection._id }}"><i class="bx bx-trash" style="margin-left: 10px; font-size: 20px;"></i></a>
                            </div>
                        </div>
                        
                        {% elif collection.category == 'filter-money' %}
                            <div class="col-lg-4 col-md-6 portfolio-item filter-money">
                                <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                                <div class="portfolio-info">
                                    <h4>{{ collection.name }}</h4>
                                    <p>{{ collection.description }}</p>
                                    <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                    <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bx-plus"></i></a>
                                    <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                    <a href="#" class="card-text edit-btn" title="Edit" data-bs-toggle="modal" data-bs-target="#editBucketModal{{ collection._id }}"><i class="bx bx-edit" style="margin-left: 10px; font-size: 20px;"></i></a>
                                    <a href="#" class="card-text delete-btn" title="Delete" data-bs-toggle="modal" data-bs-target="#deleteBucketModal{{ collection._id }}"><i class="bx bx-trash" style="margin-left: 10px; font-size: 20px;"></i></a>
                                </div>
                            </div>
                        {% elif collection.category == 'filter-hand' %}
                            <div class="col-lg-4 col-md-6 portfolio-item filter-hand">
                                <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                                <div class="portfolio-info">
                                    <h4>{{ collection.name }}</h4>
                                    <p>{{ collection.description }}</p>
                                    <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                    <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bx-plus"></i></a>
                                    <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                    <a href="#" class="card-text edit-btn" title="Edit" data-bs-toggle="modal" data-bs-target="#editBucketModal{{ collection._id }}"><i class="bx bx-edit" style="margin-left: 10px; font-size: 20px;"></i></a>
                                    <a href="#" class="card-text delete-btn" title="Delete" data-bs-toggle="modal" data-bs-target="#deleteBucketModal{{ collection._id }}"><i class="bx bx-trash" style="margin-left: 10px; font-size: 20px;"></i></a>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                
            </div>
        </section>
    </main>


    <!-- Modal Edit Bucket -->
    {% for collection in collections %}
    <div class="modal fade" id="editBucketModal{{ collection._id }}" tabindex="-1" aria-labelledby="editBucketModalLabel{{ collection._id }}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editBucketModalLabel{{ collection._id }}">Edit Bucket</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="{{ url_for('edit_bucket') }}" method="post" enctype="multipart/form-data">
                    
                        <div class="modal-body">
                            <input type="hidden" id="editBucketId" name="bucketId" value="{{ collection._id }}">
                            <div class="mb-3">
                                <label for="editName" class="form-label">Nama</label>
                                <input type="text" class="form-control" id="editName" name="name" value="{{ collection.name }}" required>
                            </div>
                            <div class="mb-3">
                                <label for="editDescription" class="form-label">Deskripsi</label>
                                <textarea class="form-control" id="editDescription" name="description" rows="3" required>{{ collection.description }}</textarea>
                            </div>
                            <div class="mb-3">
                                <label for="editPrice" class="form-label">Harga</label>
                                <input type="number" class="form-control" id="editPrice" name="price" value="{{ collection.price }}" required>
                            </div>
                            <div class="mb-3">
                                <label for="editCategory" class="form-label">Kategori</label>
                                <select class="form-control" id="editCategory" name="category" required>
                                    {% if collection.category == 'filter-artificial' %}
                                        <option value="filter-artificial" selected>Artificial Full Flower Hand Bouquet</option>
                                        <option value="filter-money">Money Hand Bouquet</option>
                                        <option value="filter-hand">Hand Bouquet Snack</option>
                                    {% elif collection.category == 'filter-money' %}
                                        <option value="filter-artificial">Artificial Full Flower Hand Bouquet</option>
                                        <option value="filter-money" selected>Money Hand Bouquet</option>
                                        <option value="filter-hand">Hand Bouquet Snack</option>
                                    {% elif collection.category == 'filter-hand' %}
                                        <option value="filter-artificial">Artificial Full Flower Hand Bouquet</option>
                                        <option value="filter-money">Money Hand Bouquet</option>
                                        <option value="filter-hand" selected>Hand Bouquet Snack</option>
                                    {% endif %}
                                </select>
                            </div>  
                            <div class="mb-3">
                                <label for="image" class="form-label">Gambar</label>
                                <input type="file" class="form-control" id="image" name="image" value="{{ collection.image }}">
                                <small class="form-text text-muted">Kosongkan jika tidak ingin mengubah gambar.</small>
                            </div> 
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                            <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
                        </div>
                </form>
            </div>
        </div>
    </div>
    {% endfor %}

    <!-- Modal Hapus Bucket -->
    {% for collection in collections %}
    <div class="modal fade" id="deleteBucketModal{{ collection._id }}" tabindex="-1" aria-labelledby="deleteBucketModalLabel{{ collection._id }}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteBucketModalLabel{{ collection._id }}">Hapus Bucket</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="{{ url_for('delete_bucket') }}" method="post">
                    <div class="modal-body">
                        <input type="hidden" id="deleteBucketId" name="bucketId" value="{{ collection._id }}">
                        <p>Apakah Anda yakin ingin menghapus bucket ini?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="submit" class="btn btn-danger">Hapus</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endfor %}


        <!-- Tambah Bucket Modal -->
    <div class="modal fade" id="tambahBucketModal" tabindex="-1" aria-labelledby="tambahBucketModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="tambahBucketModalLabel">Tambah Bucket</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="{{ url_for('tambah_koleksi') }}" method="post" enctype="multipart/form-data">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="name" class="form-label">Nama</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="description" class="form-label">Deskripsi</label>
                            <textarea class="form-control" id="description" name="description" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="price" class="form-label">Harga</label>
                            <input type="number" class="form-control" id="price" name="price" required>
                        </div>
                        <div class="mb-3">
                            <label for="category" class="form-label">Kategori</label>
                            <select class="form-control" id="category" name="category" required>
                                <option value="filter-artificial">Artificial Full Flower Hand Bouquet</option>
                                <option value="filter-money">Money Hand Bouquet</option>
                                <option value="filter-hand">Hand Bouquet Snack</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="image" class="form-label">Gambar</label>
                            <input type="file" class="form-control" id="image" name="image" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="submit" class="btn btn-primary">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="footer">
        <div class="container">
            <div class="credits">
                <div class="social-links">
                    <a href="https://www.instagram.com/navirins/" class="instagram"><i class="bx bxl-instagram"></i></a>
                </div>
            </div>
            <div class="copyright">
                &copy; Hak Cipta <strong><span>Navirin's</span></strong>. All Rights Reserved
              </div>
        </div>
    </footer>

    <div id="preloader"></div>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

    <!-- JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/@srexi/purecounterjs/dist/purecounter_vanilla.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/js/glightbox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/isotope-layout@3.0.6/dist/isotope.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vef91dfe02fce4ee0ad053f6de4f175db1715022073587" integrity="sha512-sDIX0kl85v1Cl5tu4WGLZCpH/dV9OHbA4YlKCuCiMmOQIk4buzoYDZSFj+TvC71mOBLh8CDC/REgE0GX0xcbjA==" data-cf-beacon='{"rayId":"888acaedeb29797c","version":"2024.4.1","token":"68c5ca450bae485a842ff76066d69420"}' crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const filters = document.querySelectorAll('#portfolio-flters li');
        const descriptions = document.querySelectorAll('.filter-description');

        filters.forEach(filter => {
            filter.addEventListener('click', () => {
                descriptions.forEach(description => {
                    description.style.display = 'none';
                });

                const filterClass = filter.getAttribute('data-filter').substring(1) + '-description';
                const activeDescription = document.getElementById(filterClass);
                if (activeDescription) {
                    activeDescription.style.display = 'block';
                }
            });
        });

        // Tampilkan deskripsi untuk filter aktif pertama kali
        document.querySelector('.filter-active').click();
    });

        // Fungsi untuk menampilkan alert dan mengarahkan kembali ke halaman koleksi setelah operasi berhasil
        function showAlertAndRedirect(message) {
            const Toast = Swal.mixin({
                toast: true,
                position: 'top',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer);
                    toast.addEventListener('mouseleave', Swal.resumeTimer);
                }
            });

            Toast.fire({
                icon: 'success',
                title: message
            });

            setTimeout(function() {
                window.location.href = '/koleksi';
            }, 3000);
        }

        $(document).ready(function() {
            // Ajax untuk menambah bucket
            $('#tambahBucketModal form').submit(function(event) {
                event.preventDefault(); // Mencegah form dari pengiriman standar
                var formData = new FormData($(this)[0]);

                $.ajax({
                    url: "{{ url_for('tambah_koleksi') }}",
                    type: 'POST',
                    data: formData,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil ditambahkan');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });

            // Ajax untuk mengedit bucket
            {% for collection in collections %}
            $('#editBucketModal{{ collection._id }} form').submit(function(event) {
                event.preventDefault();
                var formData = new FormData($(this)[0]);

                $.ajax({
                    url: "{{ url_for('edit_bucket') }}",
                    type: 'POST',
                    data: formData,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil diedit');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
            {% endfor %}

            // Ajax untuk menghapus bucket
            {% for collection in collections %}
            $('#deleteBucketModal{{ collection._id }} form').submit(function(event) {
                event.preventDefault();

                $.ajax({
                    url: "{{ url_for('delete_bucket') }}",
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil dihapus');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
            {% endfor %}
        });
        
        function logout() {
            $.removeCookie('bouquet', { path: '/' })
            Swal.fire({
                title: "Keluar",
                text: "Apakah Anda yakin ingin keluar dari website ini?",
                icon: "warning",
                showClass: {
                    popup: `
                        animate__animated
                        animate__fadeInDown
                    `
                },
                showCloseButton: true,
                showCancelButton: true,
                confirmButtonText: "Yakin",
                cancelButtonText: "Batal",
                hideClass: {
                    popup: `
                        animate__animated
                        animate__fadeOut
                    `
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'top',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        },
                        showClass: {
                            popup: `
                                animate__animated
                                animate__zoomIn
                            `
                        }
                    });
                    Toast.fire({
                        icon: 'success',
                        title: 'Berhasil keluar'
                    });
                    setTimeout(function () {
                        window.location.href = '/';
                    }, 3000);
                }
            });
        }
    </script>

</body>

</html>