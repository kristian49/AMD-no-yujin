{% include 'user/templates/header.html' %}
    <main id="main" class="py-5">
        <div class="container py-5 d-flex justify-content-center">
            <div class="container mt-5" data-aos="fade-down">
                <div class="section-title">
                    <h2>Pembayaran</h2>
                    <p>Form Pembayaran</p>
                </div>
                <hr class="mb-5">
                <form method="POST" action="{{ url_for('submit_purchase') }}" enctype="multipart/form-data">
                    <input type="hidden" name="order_id" value="{{ order._id }}">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="bucket_name" class="form-label">Nama Buket</label>
                            <input type="text" class="form-control" id="bucket_name" value="{{ order.bucket_name }}" readonly>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="quantity" class="form-label">Kuantitas</label>
                            <input type="number" class="form-control" id="quantity" value="{{ order.quantity }}" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="total_price" class="form-label">Total Harga</label>
                            <input type="text" class="form-control" id="total_price" value="Rp {{ order.total_price }}" readonly>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Nama</label>
                            <input type="text" class="form-control" id="name" value="{{ order.name }}" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" value="{{ order.useremail }}" readonly>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label">No Telepon</label>
                            <input type="text" class="form-control" id="phone" value="{{ order.phone }}" readonly>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="address" class="form-label">Alamat</label>
                        <textarea class="form-control" id="address" rows="3" readonly>{{ order.address }}</textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="shippingMethod" class="form-label">Metode Pengiriman</label>
                            <select class="form-select" id="shippingMethod" name="shippingMethod" required>
                                <option value="kurir">Kurir</option>
                                <option value="ojek_online">Ojek Online</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="paymentMethod" class="form-label">Pembayaran</label>
                            <div id="paymentMethod">
                                <img src="/static/user/img/qris-image.png" alt="QRIS" style="width: 100%; max-width: 200px;" />
                            </div>
                        </div>
                        
                    </div>
                    <div class="mb-3">
                        <label for="paymentProof" class="form-label">Upload Bukti Pembayaran</label>
                        <input type="file" class="form-control" id="paymentProof" name="paymentProof" required>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <button type="submit" class="form-control btn btn-outline-success">Bayar</button>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="/koleksi" class="form-control btn btn-outline-dark">Batal</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>
<<<<<<< HEAD
=======
    
    <!-- Footer -->
>>>>>>> 9523aadfc084883ca96443d39dd54bf0162aa853

    <script>
        $(document).ready(function() {
            // Submit form pembayaran
            $('form').submit(function(event) {
                event.preventDefault(); // Mencegah form dari pengiriman standar
                var formData = new FormData($(this)[0]);
    
                $.ajax({
                    url: "{{ url_for('submit_purchase') }}",
                    type: 'POST',
                    data: formData,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        // Tampilkan SweetAlert ketika pembayaran berhasil
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer);
                                toast.addEventListener('mouseleave', Swal.resumeTimer);
                            }
                        });
    
                        Toast.fire({
                            icon: 'success',
                            title: response.message
                        });
    
                        // Arahkan ke halaman profil setelah 3 detik
                        setTimeout(function() {
                            window.location.href = '/koleksi';
                        }, 3000);
                    },
                    error: function(xhr, status, error) {
                        // Tangani kesalahan jika ada
                        console.error(xhr.responseText);
                    }
                });
            });
        });
    </script>
    
{% include 'user/templates/footer.html' %}