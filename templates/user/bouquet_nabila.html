{% include 'user/templates/header.html' %}
    <main id="main" class="mt-5">

        <!-- Koleksi Section -->
        <section id="portfolio" class="portfolio">
            <div class="container" data-aos="fade-up">
                <div class="section-title">
                    <h2>Koleksi Bucket</h2>
                    <p>Pilihan Koleksi Bucket</p>
                </div>

                <div class="row" data-aos="fade-up" data-aos-delay="100">
                    <div class="col-lg-12 d-flex justify-content-center">
                        <ul id="portfolio-flters">
                            <li data-filter="*" class="filter-active">Semua</li>
                            <li data-filter=".filter-atificial">Artificial Full Flower Hand Bouquet</li>
                            <li data-filter=".filter-money">Money Hand Bouquet</li>
                            <li data-filter=".filter-hand">Hand Bouquet Snack</li>
                        </ul>
                    </div>
                </div>

                <!-- Deskripsi Filter -->
                <div class="row" data-aos="fade-up" data-aos-delay="150">
                    <div class="col-md-12 md-5 d-flex justify-content-center">
                        <div id="filter-descriptions">
                            <div class="filter-description" id="filter-atificial-description">
                                <p>
                                    <small>Bunga artificial adalah bunga yang berbahan sintesis atau plastic.
                                    Meskipun tidak hidup, bunga artificial memiliki daya tarik dan kegunaan yang tak kalah indah.Tidak heran kalau bunga artificial ini popular di berbagai macam acara.</small>
                                </p>
                                <hr>
                            </div>
                            <div class="filter-description" id="filter-money-description">
                                <p>
                                    <small>Bunga uang yang terdiri atas artificial flowers dan uang tunai. Merupakan pilihan yang praktis dan tepat untuk diberikan sebagai hadiah atau bentuk penghargaan, sangat cocok di berbagai acara dan kalangan.
                                    Kamu bisa memilih pecahan uang berapa saja untuk ditambahkan di Money Bouquet. Harga untuk produk ini sudah termasuk artificial flowers dan belum termasuk uang tunai yang diinginkan.</small>
                                </p>
                                <hr>
                            </div>
                            <div class="filter-description" id="filter-hand-description">
                                <p>
                                    <small>Bunga snack yang berisi aneka macam snack. Isi snack dari buket ini dapat kamu request sesuai dengan keinginan kamu. 
                                    Harga udah termasuk artificial flowers dan belum termasuk snack dan kartu ucapan.</small>
                                </p>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row portfolio-container mt-3" data-aos="fade-up" data-aos-delay="200">
                    {% for collection in collections %}
                        {% if collection.category == 'filter-artificial' %}
                        <div class="col-lg-4 col-md-6 portfolio-item filter-atificial">
                            <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                            <div class="portfolio-info">
                                <h4>{{ collection.name }}</h4>
                                <p>{{ collection.description }}</p>
                                <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bxs-zoom-in"></i></a>
                                <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                
                            </div>
                        </div>
                        
                        {% elif collection.category == 'filter-money' %}
                            <div class="col-lg-4 col-md-6 portfolio-item filter-money">
                                <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                                <div class="portfolio-info">
                                    <h4>{{ collection.name }}</h4>
                                    <p>{{ collection.description }}</p>
                                    <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                    <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bxs-zoom-in"></i></a>
                                    <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                   
                                </div>
                            </div>
                        {% elif collection.category == 'filter-hand' %}
                            <div class="col-lg-4 col-md-6 portfolio-item filter-hand">
                                <img src="{{ url_for('static', filename=collection.image) }}" class="img-fluid portfolio-img" alt="{{ collection.name }}">
                                <div class="portfolio-info">
                                    <h4>{{ collection.name }}</h4>
                                    <p>{{ collection.description }}</p>
                                    <p class="card-text"><strong>Rp. {{ collection.price }}</strong></p><br>
                                    <a href="{{ url_for('static', filename=collection.image) }}" data-gallery="portfolioGallery" class="portfolio-lightbox preview-link" title="{{ collection.name }}"><i class="bx bxs-zoom-in"></i></a>
                                    <a href="{{ url_for('order_form', collection_id=collection._id) }}" class="details-link" title="More Details"><i class="bx bx-cart" style="margin-left: 10px;"></i></a>
                                    
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                
            </div>
        </section>
    </main>

    <!-- Footer -->
    {% include 'user/templates/footer.html' %}

    <!-- JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/@srexi/purecounterjs/dist/purecounter_vanilla.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/js/glightbox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/isotope-layout@3.0.6/dist/isotope.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vef91dfe02fce4ee0ad053f6de4f175db1715022073587" integrity="sha512-sDIX0kl85v1Cl5tu4WGLZCpH/dV9OHbA4YlKCuCiMmOQIk4buzoYDZSFj+TvC71mOBLh8CDC/REgE0GX0xcbjA==" data-cf-beacon='{"rayId":"888acaedeb29797c","version":"2024.4.1","token":"68c5ca450bae485a842ff76066d69420"}' crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const filters = document.querySelectorAll('#portfolio-flters li');
        const descriptions = document.querySelectorAll('.filter-description');

        filters.forEach(filter => {
            filter.addEventListener('click', () => {
                descriptions.forEach(description => {
                    description.style.display = 'none';
                });

                const filterClass = filter.getAttribute('data-filter').substring(1) + '-description';
                const activeDescription = document.getElementById(filterClass);
                if (activeDescription) {
                    activeDescription.style.display = 'block';
                }
            });
        });

        // Tampilkan deskripsi untuk filter aktif pertama kali
        document.querySelector('.filter-active').click();
    });

        // Fungsi untuk menampilkan alert dan mengarahkan kembali ke halaman koleksi setelah operasi berhasil
        function showAlertAndRedirect(message) {
            const Toast = Swal.mixin({
                toast: true,
                position: 'top',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer);
                    toast.addEventListener('mouseleave', Swal.resumeTimer);
                }
            });

            Toast.fire({
                icon: 'success',
                title: message
            });

            setTimeout(function() {
                window.location.href = '/koleksi';
            }, 3000);
        }

        $(document).ready(function() {
            // Ajax untuk menambah bucket
            $('#tambahBucketModal form').submit(function(event) {
                event.preventDefault(); // Mencegah form dari pengiriman standar
                var formData = new FormData($(this)[0]);

                $.ajax({
                    url: "{{ url_for('tambah_koleksi') }}",
                    type: 'POST',
                    data: formData,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil ditambahkan');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });

            // Ajax untuk mengedit bucket
            {% for collection in collections %}
            $('#editBucketModal{{ collection._id }} form').submit(function(event) {
                event.preventDefault();
                var formData = new FormData($(this)[0]);

                $.ajax({
                    url: "{{ url_for('edit_bucket') }}",
                    type: 'POST',
                    data: formData,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil diedit');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
            {% endfor %}

            // Ajax untuk menghapus bucket
            {% for collection in collections %}
            $('#deleteBucketModal{{ collection._id }} form').submit(function(event) {
                event.preventDefault();

                $.ajax({
                    url: "{{ url_for('delete_bucket') }}",
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function(response) {
                        showAlertAndRedirect('Bucket berhasil dihapus');
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
            {% endfor %}
        });
    </script>

</body>

</html>